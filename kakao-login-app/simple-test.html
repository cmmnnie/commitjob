<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>간단한 백엔드 연결 테스트</title>
</head>
<body>
    <h1>백엔드 연결 테스트</h1>
    <p>현재 URL: <span id="currentUrl"></span></p>
    <button onclick="testBackend()">백엔드 테스트</button>
    <pre id="result"></pre>

    <h2>중요: 브라우저 콘솔(F12)을 확인하세요!</h2>

    <script>
        document.getElementById('currentUrl').textContent = window.location.href;

        async function testBackend() {
            const result = document.getElementById('result');
            result.textContent = '테스트 중...\n\n브라우저 콘솔(F12)을 확인하세요!';

            console.log('=== 백엔드 연결 테스트 시작 ===');
            console.log('프론트엔드 Origin:', window.location.origin);
            console.log('백엔드 URL:', 'http://localhost:4001');

            try {
                console.log('fetch 요청 시작...');

                const response = await fetch('http://localhost:4001/health', {
                    method: 'GET',
                    mode: 'cors',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                console.log('응답 받음:', response.status);
                console.log('응답 헤더:', [...response.headers.entries()]);

                const data = await response.json();
                console.log('응답 데이터:', data);

                result.textContent =
                    '✅ 성공!\n\n' +
                    `상태: ${response.status}\n` +
                    `응답: ${JSON.stringify(data, null, 2)}\n\n` +
                    '브라우저 콘솔에서 더 자세한 정보를 확인하세요.';

            } catch (error) {
                console.error('❌ 오류 발생:', error);
                console.error('오류 이름:', error.name);
                console.error('오류 메시지:', error.message);
                console.error('오류 스택:', error.stack);

                result.textContent =
                    '❌ 실패!\n\n' +
                    `오류: ${error.message}\n\n` +
                    '=== 해결 방법 ===\n' +
                    '1. 백엔드 서버가 실행 중인지 확인\n' +
                    '2. localhost:5500으로 접속했는지 확인 (127.0.0.1 아님!)\n' +
                    '3. 브라우저 콘솔(F12)에서 CORS 오류 확인\n' +
                    '4. 백엔드 터미널에서 로그 확인\n\n' +
                    '브라우저 콘솔에서 더 자세한 오류를 확인하세요!';
            }
        }

        // 페이지 로드 시 경고
        window.addEventListener('DOMContentLoaded', () => {
            if (window.location.hostname !== 'localhost') {
                alert('⚠️ 경고!\n\n' +
                      `현재 ${window.location.hostname}으로 접속했습니다.\n` +
                      'localhost로 접속해야 합니다!\n\n' +
                      'http://localhost:5500/kakao-login-app/simple-test.html');
            }
        });
    </script>
</body>
</html>
